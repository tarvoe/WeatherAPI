package MainFunctionsTests;

import ResponseFunctions.ResponseController;
import org.json.JSONException;
import org.json.JSONObject;
import org.junit.Test;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import static org.junit.Assert.assertEquals;
import static org.mockito.Mockito.mock;
import MainFunctions.OpenWeatherAPI;
import org.mockito.Mockito;

public class WeatherAPITests {

    private String tallinnTestDataString  = "{\"city\":{\"country\":\"EE\",\"coord\":{\"lon\":24.7454,\"lat\":59.4372},\"name\":\"Tallinn\",\"id\":590447,\"population\":16630},\"cnt\":40,\"cod\":\"200\",\"message\":0.0022,\"list\":[{\"dt\":1513166400,\"rain\":{},\"dt_txt\":\"2017-12-13 12:00:00\",\"snow\":{},\"weather\":[{\"icon\":\"01d\",\"description\":\"clear sky\",\"main\":\"Clear\",\"id\":800}],\"main\":{\"temp\":1.34,\"temp_min\":1.34,\"grnd_level\":1009.23,\"temp_kf\":-0.51,\"humidity\":100,\"pressure\":1009.23,\"sea_level\":1012.76,\"temp_max\":1.85},\"clouds\":{\"all\":0},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":230.504,\"speed\":8.41}},{\"dt\":1513177200,\"rain\":{\"3h\":0.3375},\"dt_txt\":\"2017-12-13 15:00:00\",\"snow\":{\"3h\":0.142},\"weather\":[{\"icon\":\"10n\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":0.97,\"temp_min\":0.97,\"grnd_level\":1008.95,\"temp_kf\":-0.38,\"humidity\":100,\"pressure\":1008.95,\"sea_level\":1012.48,\"temp_max\":1.36},\"clouds\":{\"all\":88},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":211.502,\"speed\":8.21}},{\"dt\":1513188000,\"rain\":{\"3h\":0.75},\"dt_txt\":\"2017-12-13 18:00:00\",\"snow\":{},\"weather\":[{\"icon\":\"10n\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":2.67,\"temp_min\":2.67,\"grnd_level\":1009.66,\"temp_kf\":-0.26,\"humidity\":100,\"pressure\":1009.66,\"sea_level\":1013.13,\"temp_max\":2.93},\"clouds\":{\"all\":20},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":225,\"speed\":9.86}},{\"dt\":1513198800,\"rain\":{\"3h\":0.13},\"dt_txt\":\"2017-12-13 21:00:00\",\"snow\":{},\"weather\":[{\"icon\":\"10n\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":2.67,\"temp_min\":2.67,\"grnd_level\":1009.87,\"temp_kf\":-0.13,\"humidity\":100,\"pressure\":1009.87,\"sea_level\":1013.38,\"temp_max\":2.8},\"clouds\":{\"all\":68},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":215.001,\"speed\":9.91}},{\"dt\":1513209600,\"rain\":{\"3h\":0.07},\"dt_txt\":\"2017-12-14 00:00:00\",\"snow\":{\"3h\":0.001},\"weather\":[{\"icon\":\"10n\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":2.29,\"temp_min\":2.29,\"grnd_level\":1009.64,\"temp_kf\":0,\"humidity\":100,\"pressure\":1009.64,\"sea_level\":1013.19,\"temp_max\":2.29},\"clouds\":{\"all\":76},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":204.502,\"speed\":10.57}},{\"dt\":1513220400,\"rain\":{\"3h\":0.01},\"dt_txt\":\"2017-12-14 03:00:00\",\"snow\":{\"3h\":2.4999999999997E-4},\"weather\":[{\"icon\":\"10n\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":1.34,\"temp_min\":1.34,\"grnd_level\":1009.26,\"temp_kf\":0,\"humidity\":100,\"pressure\":1009.26,\"sea_level\":1012.77,\"temp_max\":1.34},\"clouds\":{\"all\":20},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":196.001,\"speed\":9.99}},{\"dt\":1513231200,\"rain\":{},\"dt_txt\":\"2017-12-14 06:00:00\",\"snow\":{},\"weather\":[{\"icon\":\"03n\",\"description\":\"scattered clouds\",\"main\":\"Clouds\",\"id\":802}],\"main\":{\"temp\":0.13,\"temp_min\":0.13,\"grnd_level\":1008.82,\"temp_kf\":0,\"humidity\":100,\"pressure\":1008.82,\"sea_level\":1012.4,\"temp_max\":0.13},\"clouds\":{\"all\":32},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":182.003,\"speed\":9.72}},{\"dt\":1513242000,\"rain\":{},\"dt_txt\":\"2017-12-14 09:00:00\",\"snow\":{\"3h\":0.00125},\"weather\":[{\"icon\":\"01d\",\"description\":\"clear sky\",\"main\":\"Clear\",\"id\":800}],\"main\":{\"temp\":-1.26,\"temp_min\":-1.26,\"grnd_level\":1008.44,\"temp_kf\":0,\"humidity\":100,\"pressure\":1008.44,\"sea_level\":1012.01,\"temp_max\":-1.26},\"clouds\":{\"all\":0},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":172.001,\"speed\":9.78}},{\"dt\":1513252800,\"rain\":{},\"dt_txt\":\"2017-12-14 12:00:00\",\"snow\":{\"3h\":0.0325},\"weather\":[{\"icon\":\"13d\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.98,\"temp_min\":-1.98,\"grnd_level\":1007.03,\"temp_kf\":0,\"humidity\":100,\"pressure\":1007.03,\"sea_level\":1010.59,\"temp_max\":-1.98},\"clouds\":{\"all\":32},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":164.003,\"speed\":8.82}},{\"dt\":1513263600,\"rain\":{},\"dt_txt\":\"2017-12-14 15:00:00\",\"snow\":{\"3h\":0.0425},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-2.4,\"temp_min\":-2.4,\"grnd_level\":1005.89,\"temp_kf\":0,\"humidity\":100,\"pressure\":1005.89,\"sea_level\":1009.51,\"temp_max\":-2.4},\"clouds\":{\"all\":64},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":154.502,\"speed\":8.61}},{\"dt\":1513274400,\"rain\":{},\"dt_txt\":\"2017-12-14 18:00:00\",\"snow\":{\"3h\":0.09},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-2.58,\"temp_min\":-2.58,\"grnd_level\":1004.62,\"temp_kf\":0,\"humidity\":100,\"pressure\":1004.62,\"sea_level\":1008.12,\"temp_max\":-2.58},\"clouds\":{\"all\":80},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":150.501,\"speed\":8.91}},{\"dt\":1513285200,\"rain\":{},\"dt_txt\":\"2017-12-14 21:00:00\",\"snow\":{\"3h\":0.2525},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-2.24,\"temp_min\":-2.24,\"grnd_level\":1002.88,\"temp_kf\":0,\"humidity\":100,\"pressure\":1002.88,\"sea_level\":1006.45,\"temp_max\":-2.24},\"clouds\":{\"all\":80},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":144.5,\"speed\":8.46}},{\"dt\":1513296000,\"rain\":{},\"dt_txt\":\"2017-12-15 00:00:00\",\"snow\":{\"3h\":0.2475},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.8,\"temp_min\":-1.8,\"grnd_level\":1001.32,\"temp_kf\":0,\"humidity\":100,\"pressure\":1001.32,\"sea_level\":1004.9,\"temp_max\":-1.8},\"clouds\":{\"all\":92},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":137.005,\"speed\":8.11}},{\"dt\":1513306800,\"rain\":{},\"dt_txt\":\"2017-12-15 03:00:00\",\"snow\":{\"3h\":0.5775},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.61,\"temp_min\":-1.61,\"grnd_level\":1000.65,\"temp_kf\":0,\"humidity\":100,\"pressure\":1000.65,\"sea_level\":1004.12,\"temp_max\":-1.61},\"clouds\":{\"all\":80},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":136.502,\"speed\":7.61}},{\"dt\":1513317600,\"rain\":{},\"dt_txt\":\"2017-12-15 06:00:00\",\"snow\":{\"3h\":0.955},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.36,\"temp_min\":-1.36,\"grnd_level\":1000.34,\"temp_kf\":0,\"humidity\":100,\"pressure\":1000.34,\"sea_level\":1003.93,\"temp_max\":-1.36},\"clouds\":{\"all\":92},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":138.502,\"speed\":6.27}},{\"dt\":1513328400,\"rain\":{},\"dt_txt\":\"2017-12-15 09:00:00\",\"snow\":{\"3h\":0.335},\"weather\":[{\"icon\":\"13d\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-0.79,\"temp_min\":-0.79,\"grnd_level\":1000.88,\"temp_kf\":0,\"humidity\":100,\"pressure\":1000.88,\"sea_level\":1004.46,\"temp_max\":-0.79},\"clouds\":{\"all\":92},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":145.504,\"speed\":5.02}},{\"dt\":1513339200,\"rain\":{\"3h\":0.02},\"dt_txt\":\"2017-12-15 12:00:00\",\"snow\":{\"3h\":0.245},\"weather\":[{\"icon\":\"10d\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":0.63,\"temp_min\":0.63,\"grnd_level\":1001.16,\"temp_kf\":0,\"humidity\":100,\"pressure\":1001.16,\"sea_level\":1004.65,\"temp_max\":0.63},\"clouds\":{\"all\":92},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":150.001,\"speed\":4.22}},{\"dt\":1513350000,\"rain\":{\"3h\":0.05},\"dt_txt\":\"2017-12-15 15:00:00\",\"snow\":{\"3h\":0.22},\"weather\":[{\"icon\":\"10n\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":1.45,\"temp_min\":1.45,\"grnd_level\":1001.8,\"temp_kf\":0,\"humidity\":100,\"pressure\":1001.8,\"sea_level\":1005.34,\"temp_max\":1.45},\"clouds\":{\"all\":88},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":175.503,\"speed\":4.85}},{\"dt\":1513360800,\"rain\":{\"3h\":0.01},\"dt_txt\":\"2017-12-15 18:00:00\",\"snow\":{\"3h\":0.02},\"weather\":[{\"icon\":\"10n\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":0.64,\"temp_min\":0.64,\"grnd_level\":1002.39,\"temp_kf\":0,\"humidity\":100,\"pressure\":1002.39,\"sea_level\":1005.83,\"temp_max\":0.64},\"clouds\":{\"all\":80},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":159.001,\"speed\":4.9}},{\"dt\":1513371600,\"rain\":{},\"dt_txt\":\"2017-12-15 21:00:00\",\"snow\":{\"3h\":0.17},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-0.72,\"temp_min\":-0.72,\"grnd_level\":1001.85,\"temp_kf\":0,\"humidity\":100,\"pressure\":1001.85,\"sea_level\":1005.45,\"temp_max\":-0.72},\"clouds\":{\"all\":92},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":122.001,\"speed\":3.41}},{\"dt\":1513382400,\"rain\":{},\"dt_txt\":\"2017-12-16 00:00:00\",\"snow\":{\"3h\":1.005},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.04,\"temp_min\":-1.04,\"grnd_level\":1002.33,\"temp_kf\":0,\"humidity\":100,\"pressure\":1002.33,\"sea_level\":1005.86,\"temp_max\":-1.04},\"clouds\":{\"all\":88},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":108.003,\"speed\":2.36}},{\"dt\":1513393200,\"rain\":{},\"dt_txt\":\"2017-12-16 03:00:00\",\"snow\":{\"3h\":0.79},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.36,\"temp_min\":-1.36,\"grnd_level\":1003.06,\"temp_kf\":0,\"humidity\":100,\"pressure\":1003.06,\"sea_level\":1006.61,\"temp_max\":-1.36},\"clouds\":{\"all\":76},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":116.503,\"speed\":1.71}},{\"dt\":1513404000,\"rain\":{},\"dt_txt\":\"2017-12-16 06:00:00\",\"snow\":{\"3h\":0.03},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-3.85,\"temp_min\":-3.85,\"grnd_level\":1004.11,\"temp_kf\":0,\"humidity\":100,\"pressure\":1004.11,\"sea_level\":1007.72,\"temp_max\":-3.85},\"clouds\":{\"all\":0},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":134.5,\"speed\":2.11}},{\"dt\":1513414800,\"rain\":{},\"dt_txt\":\"2017-12-16 09:00:00\",\"snow\":{\"3h\":0.13},\"weather\":[{\"icon\":\"13d\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-2.61,\"temp_min\":-2.61,\"grnd_level\":1005.63,\"temp_kf\":0,\"humidity\":100,\"pressure\":1005.63,\"sea_level\":1009.29,\"temp_max\":-2.61},\"clouds\":{\"all\":56},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":124.501,\"speed\":4.53}},{\"dt\":1513425600,\"rain\":{\"3h\":0.01},\"dt_txt\":\"2017-12-16 12:00:00\",\"snow\":{\"3h\":0.77},\"weather\":[{\"icon\":\"10d\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":0.8,\"temp_min\":0.8,\"grnd_level\":1006.38,\"temp_kf\":0,\"humidity\":100,\"pressure\":1006.38,\"sea_level\":1009.93,\"temp_max\":0.8},\"clouds\":{\"all\":76},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":160.503,\"speed\":4.26}},{\"dt\":1513436400,\"rain\":{\"3h\":0.03},\"dt_txt\":\"2017-12-16 15:00:00\",\"snow\":{\"3h\":0.11},\"weather\":[{\"icon\":\"10n\",\"description\":\"light rain\",\"main\":\"Rain\",\"id\":500}],\"main\":{\"temp\":0.48,\"temp_min\":0.48,\"grnd_level\":1008.07,\"temp_kf\":0,\"humidity\":100,\"pressure\":1008.07,\"sea_level\":1011.56,\"temp_max\":0.48},\"clouds\":{\"all\":36},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":168.504,\"speed\":6.36}},{\"dt\":1513447200,\"rain\":{},\"dt_txt\":\"2017-12-16 18:00:00\",\"snow\":{\"3h\":0.02},\"weather\":[{\"icon\":\"01n\",\"description\":\"clear sky\",\"main\":\"Clear\",\"id\":800}],\"main\":{\"temp\":-1.08,\"temp_min\":-1.08,\"grnd_level\":1009.1,\"temp_kf\":0,\"humidity\":100,\"pressure\":1009.1,\"sea_level\":1012.66,\"temp_max\":-1.08},\"clouds\":{\"all\":56},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":147.502,\"speed\":5.31}},{\"dt\":1513458000,\"rain\":{},\"dt_txt\":\"2017-12-16 21:00:00\",\"snow\":{\"3h\":0.034999999999999},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.42,\"temp_min\":-1.42,\"grnd_level\":1009.91,\"temp_kf\":0,\"humidity\":100,\"pressure\":1009.91,\"sea_level\":1013.53,\"temp_max\":-1.42},\"clouds\":{\"all\":56},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":141.501,\"speed\":5.06}},{\"dt\":1513468800,\"rain\":{},\"dt_txt\":\"2017-12-17 00:00:00\",\"snow\":{\"3h\":0.045},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.97,\"temp_min\":-1.97,\"grnd_level\":1010.71,\"temp_kf\":0,\"humidity\":100,\"pressure\":1010.71,\"sea_level\":1014.37,\"temp_max\":-1.97},\"clouds\":{\"all\":80},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":134.001,\"speed\":4.02}},{\"dt\":1513479600,\"rain\":{},\"dt_txt\":\"2017-12-17 03:00:00\",\"snow\":{\"3h\":0.515},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.77,\"temp_min\":-1.77,\"grnd_level\":1011.49,\"temp_kf\":0,\"humidity\":100,\"pressure\":1011.49,\"sea_level\":1015.08,\"temp_max\":-1.77},\"clouds\":{\"all\":88},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":109.5,\"speed\":4.03}},{\"dt\":1513490400,\"rain\":{},\"dt_txt\":\"2017-12-17 06:00:00\",\"snow\":{\"3h\":0.37},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.66,\"temp_min\":-1.66,\"grnd_level\":1012.69,\"temp_kf\":0,\"humidity\":100,\"pressure\":1012.69,\"sea_level\":1016.25,\"temp_max\":-1.66},\"clouds\":{\"all\":92},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":110.504,\"speed\":4.22}},{\"dt\":1513501200,\"rain\":{},\"dt_txt\":\"2017-12-17 09:00:00\",\"snow\":{\"3h\":0.19},\"weather\":[{\"icon\":\"13d\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.7,\"temp_min\":-1.7,\"grnd_level\":1014.39,\"temp_kf\":0,\"humidity\":100,\"pressure\":1014.39,\"sea_level\":1018.08,\"temp_max\":-1.7},\"clouds\":{\"all\":88},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":116.502,\"speed\":3.41}},{\"dt\":1513512000,\"rain\":{},\"dt_txt\":\"2017-12-17 12:00:00\",\"snow\":{\"3h\":0.075},\"weather\":[{\"icon\":\"13d\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.42,\"temp_min\":-1.42,\"grnd_level\":1015.87,\"temp_kf\":0,\"humidity\":100,\"pressure\":1015.87,\"sea_level\":1019.44,\"temp_max\":-1.42},\"clouds\":{\"all\":80},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":97.5045,\"speed\":2.16}},{\"dt\":1513522800,\"rain\":{},\"dt_txt\":\"2017-12-17 15:00:00\",\"snow\":{\"3h\":0.025},\"weather\":[{\"icon\":\"01n\",\"description\":\"clear sky\",\"main\":\"Clear\",\"id\":800}],\"main\":{\"temp\":-3.14,\"temp_min\":-3.14,\"grnd_level\":1017.79,\"temp_kf\":0,\"humidity\":100,\"pressure\":1017.79,\"sea_level\":1021.45,\"temp_max\":-3.14},\"clouds\":{\"all\":8},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":53.0022,\"speed\":1.52}},{\"dt\":1513533600,\"rain\":{},\"dt_txt\":\"2017-12-17 18:00:00\",\"snow\":{\"3h\":0.02},\"weather\":[{\"icon\":\"01n\",\"description\":\"clear sky\",\"main\":\"Clear\",\"id\":800}],\"main\":{\"temp\":-7.15,\"temp_min\":-7.15,\"grnd_level\":1019.08,\"temp_kf\":0,\"humidity\":100,\"pressure\":1019.08,\"sea_level\":1022.92,\"temp_max\":-7.15},\"clouds\":{\"all\":32},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":41.003,\"speed\":1.06}},{\"dt\":1513544400,\"rain\":{},\"dt_txt\":\"2017-12-17 21:00:00\",\"snow\":{\"3h\":0.045},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-4.3,\"temp_min\":-4.3,\"grnd_level\":1020.4,\"temp_kf\":0,\"humidity\":100,\"pressure\":1020.4,\"sea_level\":1024.11,\"temp_max\":-4.3},\"clouds\":{\"all\":76},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":316.501,\"speed\":1.56}},{\"dt\":1513555200,\"rain\":{},\"dt_txt\":\"2017-12-18 00:00:00\",\"snow\":{\"3h\":0.03},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-3.83,\"temp_min\":-3.83,\"grnd_level\":1021.21,\"temp_kf\":0,\"humidity\":100,\"pressure\":1021.21,\"sea_level\":1024.98,\"temp_max\":-3.83},\"clouds\":{\"all\":80},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":313.002,\"speed\":1.97}},{\"dt\":1513566000,\"rain\":{},\"dt_txt\":\"2017-12-18 03:00:00\",\"snow\":{\"3h\":0.145},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-1.52,\"temp_min\":-1.52,\"grnd_level\":1021.97,\"temp_kf\":0,\"humidity\":100,\"pressure\":1021.97,\"sea_level\":1025.7,\"temp_max\":-1.52},\"clouds\":{\"all\":88},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":317.502,\"speed\":2.76}},{\"dt\":1513576800,\"rain\":{},\"dt_txt\":\"2017-12-18 06:00:00\",\"snow\":{\"3h\":0.055},\"weather\":[{\"icon\":\"13n\",\"description\":\"light snow\",\"main\":\"Snow\",\"id\":600}],\"main\":{\"temp\":-2.15,\"temp_min\":-2.15,\"grnd_level\":1022.73,\"temp_kf\":0,\"humidity\":100,\"pressure\":1022.73,\"sea_level\":1026.38,\"temp_max\":-2.15},\"clouds\":{\"all\":44},\"sys\":{\"pod\":\"n\"},\"wind\":{\"deg\":311.5,\"speed\":3.42}},{\"dt\":1513587600,\"rain\":{},\"dt_txt\":\"2017-12-18 09:00:00\",\"snow\":{},\"weather\":[{\"icon\":\"02d\",\"description\":\"few clouds\",\"main\":\"Clouds\",\"id\":801}],\"main\":{\"temp\":-4.22,\"temp_min\":-4.22,\"grnd_level\":1023.62,\"temp_kf\":0,\"humidity\":100,\"pressure\":1023.62,\"sea_level\":1027.31,\"temp_max\":-4.22},\"clouds\":{\"all\":20},\"sys\":{\"pod\":\"d\"},\"wind\":{\"deg\":298.001,\"speed\":2.86}}]}";

    private HashMap<String, Object> createTestHashMapWithTallinnData(){
        HashMap<String, Object> testData = new HashMap<>();
        ArrayList<Double> day1 = new ArrayList<Double>(){{add(2.29);add(-2.58);}};
        ArrayList<Double> day2 = new ArrayList<Double>(){{add(1.45);add(-1.8);}};
        ArrayList<Double> day3 = new ArrayList<Double>(){{add(0.8);add(-3.85);}};
        String date1 = "2017-12-14";
        String date2 = "2017-12-15";
        String date3 = "2017-12-16";
        testData.put(date1,day1);
        testData.put(date2,day2);
        testData.put(date3,day3);
        return testData;
    }


    @Test
    public void didItReturnLatitudeAndLongitude() throws Exception {
        ArrayList<Double> latAndLonTestData = new ArrayList<>();
        latAndLonTestData.add(59.4372);
        latAndLonTestData.add(24.7454);
        OpenWeatherAPI testOpenWeatherApi = mock(OpenWeatherAPI.class);
        ResponseController responseController = mock(ResponseController.class);
        JSONObject tallinnDataInJSon = new JSONObject(tallinnTestDataString);

        Mockito.when(testOpenWeatherApi.getLanLotOfCityFromUrlResponseInArrayList(tallinnDataInJSon, responseController)).thenReturn(latAndLonTestData);
        assertEquals(testOpenWeatherApi.getLanLotOfCityFromUrlResponseInArrayList(tallinnDataInJSon, responseController).size(), latAndLonTestData.size());
        assertEquals(testOpenWeatherApi.getLanLotOfCityFromUrlResponseInArrayList(tallinnDataInJSon, responseController).get(0), latAndLonTestData.get(0));
        assertEquals(testOpenWeatherApi.getLanLotOfCityFromUrlResponseInArrayList(tallinnDataInJSon, responseController).get(1), latAndLonTestData.get(1));
    }

    @Test
    public void testMinMaxForecastResult() throws IOException, JSONException {

        HashMap<String, Object> tallinnTestData = createTestHashMapWithTallinnData();
        OpenWeatherAPI testOpenWeatherApi = mock(OpenWeatherAPI.class);
        ResponseController responseController = mock(ResponseController.class);
        JSONObject tallinnDataInJSon = new JSONObject(tallinnTestDataString);

        Mockito.when(testOpenWeatherApi.createHashMapOfThreeDayForecast(tallinnDataInJSon, responseController)).thenReturn(tallinnTestData);
        assertEquals(testOpenWeatherApi.createHashMapOfThreeDayForecast(tallinnDataInJSon, responseController).size(), 3);
        assertEquals(tallinnTestData.get("2017-12-14"),testOpenWeatherApi.createHashMapOfThreeDayForecast(tallinnDataInJSon, responseController).get("2017-12-14") );
        assertEquals(tallinnTestData.get("2017-12-15"),testOpenWeatherApi.createHashMapOfThreeDayForecast(tallinnDataInJSon, responseController).get("2017-12-15") );
        assertEquals(tallinnTestData.get("2017-12-16"),testOpenWeatherApi.createHashMapOfThreeDayForecast(tallinnDataInJSon, responseController).get("2017-12-16") );
    }


}

